"use strict";var Grid=function(t,i){this.width=t||10,this.height=i||10,this.data=[],this.build()};Grid.prototype.build=function(){for(var t=0;t<this.height;t++){this.data.push([]);for(var i=0;i<this.width;i++)this.data[t].push(" ")}},Grid.prototype.print=function(){for(var t,i="",h=0;h<this.height;h++){t="";for(var e=0;e<this.width;e++)t+="["+this.data[h][e]+"]";i+=t+"\n"}console.log(i)},Grid.prototype.query=function(t){var i,h=[];if(this.empty(t))return!0;i=[{x:t.x,y:t.y-1,dir:"north"},{x:t.x+1,y:t.y,dir:"east"},{x:t.x,y:t.y+1,dir:"south"},{x:t.x-1,y:t.y,dir:"west"}];for(var e=0;e<i.length;e++)this.empty(i[e])&&h.push(i[e]);return h},Grid.prototype.empty=function(t){return t.x<this.width&&t.x>=0&&t.y<this.height&&t.y>=0&&" "===this.data[t.y][t.x]?!0:!1},Grid.prototype.mark=function(t){var i;switch(t.dir){case"origin":i="x";break;case"terminate":i="o";break;case"north":i="^";break;case"south":i="v";break;case"east":i=">";break;case"west":i="<";break;default:console.log("unknown direction")}this.data[t.y][t.x]=i};var Line=function(t,i){this.pos=i||{x:0,y:0},this.pos.dir="origin",this.grid=t,this.history=[],this.mobile=!1,this.place()};Line.prototype.place=function(){this.grid.query(this.pos)===!0?(this.grid.mark(this.pos),this.history.push(this.pos),this.mobile=!0):console.log("not placed")},Line.prototype.move=function(){var t=this.grid.query(this.pos);if(t.length>0){var i=t[this.rand(t.length)];this.pos=i,this.grid.mark(i),this.history.push(i)}else{this.mobile=!1;var h=this.history[this.history.length-1];h.dir="terminate",this.grid.mark(h)}},Line.prototype.rand=function(t,i){return i=i||0,Math.floor(Math.random()*(t-i))+i};var Splash=function(){this.height=0,this.width=0,this.lineNum=16};Splash.prototype.init=function(){this.getDimensions();var t=new Grid(this.width,this.height);this.lines=[];for(var i=Math.round(this.width/2)-Math.floor(this.lineNum/4),h=Math.round(this.height/2),e=0;e<this.lineNum/2;e++)this.lines.push(new Line(t,{x:i+e,y:h}));for(e=0;e<this.lineNum/2;e++)this.lines.push(new Line(t,{x:i+e,y:h-1}));for(e=0;250>e;e++)this.tick();this.draw()},Splash.prototype.getDimensions=function(){var t=function(t,i){return Math.round(Math.sqrt(t*t+i*i))};this.win={width:$(window).width(),height:$(window).height()},this.win.diag=t(this.win.width,this.win.height),$(".hole").css({height:this.win.diag,width:this.win.diag,"margin-left":-this.win.diag/2,"margin-top":-(this.win.diag-this.win.height)/2}),this.height=this.win.diag/30,this.width=this.win.diag/30},Splash.prototype.tick=function(){for(var t=0;t<this.lines.length;t++)this.lines[t].move()},Splash.prototype.timer=function(){window.setInterval(function(){},100)},Splash.prototype.draw=function(){for(var t={height:$(".hole").height(),width:$(".hole").width(),padding:50},i=d3.select(".hole").append("svg").attr("height",t.height).attr("width",t.width).append("g").attr("transform","translate(50,50)"),h={x:d3.scale.linear().domain([0,this.width-1]).rangeRound([0,t.width-2*t.padding]),y:d3.scale.linear().domain([0,this.height-1]).rangeRound([0,t.height-2*t.padding])},e=d3.svg.line().x(function(t){return h.x(t.x)}).y(function(t){return h.y(t.y)}),n=i.selectAll("path").data(this.lines).enter().append("path").attr("stroke-linecap","square").attr("stroke-width",12).attr("d",function(t){return e(t.history)}),s=0;s<n[0].length;s++)this.lines[s].pathLength=n[0][s].getTotalLength()+10;n.attr("stroke-dasharray",function(t){return t.pathLength+" "+t.pathLength}).attr("stroke-dashoffset",function(t){return t.pathLength}),window.setTimeout(function(){n.transition().duration(4e3).delay(function(t,i){return 100*i}).ease("linear").attr("stroke-dashoffset",0)},2e3)};var splash=new Splash;splash.init();